<h1 id="Ô∏è-o-que-√©-broken-access-control">‚ö†Ô∏è O que √© Broken Access Control?</h1>

<p>Refere-se a falhas em mecanismos que deveriam restringir o acesso a recursos ou funcionalidades de uma aplica√ß√£o. Isso significa que os usu√°rios podem acessar, modificar ou excluir dados ou funcionalidades que n√£o est√£o autorizados a ver ou manipular. √â uma das vulnerabilidades mais comuns e cr√≠ticas em aplica√ß√µes web, frequentemente listada entre as principais amea√ßas no <strong>OWASP Top 10</strong>.</p>

<p><img src="/assets/img/Br0k3n 4cc3ss C0ntr0l/Owasp.png" alt="alt text" title="OWASP" /></p>

<h1 id="-como-posso-encontrar">üîç Como posso encontrar?</h1>
<h3 id="1-escalonamento-horizontal">1. Escalonamento Horizontal</h3>

<p><strong>Descri√ß√£o</strong>: Um usu√°rio acessa dados de outro usu√°rio que n√£o deveria ser capaz de acessar, geralmente manipulando par√¢metros na URL ou no corpo da requisi√ß√£o.</p>

<p><strong>Exemplo de C√≥digo Vulner√°vel</strong>:</p>

<p><img src="/assets/img/Br0k3n 4cc3ss C0ntr0l/horizontal-attack.png" alt="alt text" title="Horizontal Attack" /></p>

<p><strong>Explora√ß√£o</strong>: Um atacante pode alterar o <code class="language-plaintext highlighter-rouge">user_id</code> na URL, por exemplo, de <code class="language-plaintext highlighter-rouge">http://exemplo.com/user.php?user_id=1</code> para <code class="language-plaintext highlighter-rouge">http://exemplo.com/user.php?user_id=2</code> e acessar dados de outro usu√°rio.</p>

<h3 id="2-escalonamento-vertical">2. Escalonamento Vertical</h3>

<p><strong>Descri√ß√£o</strong>: Um usu√°rio comum consegue realizar a√ß√µes administrativas que deveriam ser restritas a administradores.</p>

<p><strong>Exemplo de C√≥digo Vulner√°vel</strong>:</p>

<p><img src="/assets/img/Br0k3n 4cc3ss C0ntr0l/Vertical-attack.png" alt="alt text" title="Vertical Attack" /></p>

<p><strong>Explora√ß√£o</strong>: Um usu√°rio normal pode executar essa a√ß√£o se souber manipular o formul√°rio e enviar uma requisi√ß√£o POST para excluir um usu√°rio.</p>

<h3 id="3-controle-de-vulnerabilidade-de-acesso-em-m√∫ltiplos-estados-de-processo">3. Controle de Vulnerabilidade de Acesso em M√∫ltiplos Estados de Processo</h3>

<p><strong>Descri√ß√£o</strong>: Um usu√°rio manipula o estado de uma transa√ß√£o sem a devida valida√ß√£o.</p>

<p><strong>Exemplo de C√≥digo Vulner√°vel</strong>:</p>

<p><img src="/assets/img/Br0k3n 4cc3ss C0ntr0l/Multiplos-escalo-attack.png" alt="alt text" title="Multiplos Escalonamento Attack" /></p>

<p><strong>Explora√ß√£o</strong>: Um usu√°rio pode manipular o <code class="language-plaintext highlighter-rouge">order_id</code> para alterar o status de um pedido que n√£o lhe pertence, finalizando compras indevidas.</p>

<h3 id="conclus√£o">Conclus√£o</h3>

<p>Esses exemplos ilustram como o <strong>Broken Access Control</strong> pode ser explorado em aplica√ß√µes PHP e como implementar pr√°ticas de seguran√ßa para proteger seus sistemas. As verifica√ß√µes de permiss√£o e a valida√ß√£o de estados s√£o cruciais para evitar acessos n√£o autorizados. Se precisar de mais informa√ß√µes ou exemplos adicionais, √© s√≥ avisar!</p>

<h1 id="-como-posso-explorar-essa-vulnerabilidade">üîë Como posso explorar essa vulnerabilidade?</h1>

<p>Este laborat√≥rio armazena logs de bate-papo do usu√°rio diretamente no sistema de arquivos do servidor e os recupera usando URLs est√°ticas.</p>

<p>Resolva o laborat√≥rio descobrindo a senha do usu√°rio¬†<code class="language-plaintext highlighter-rouge">carlos</code>e efetuando login na conta dele.</p>

<p><img src="/assets/img/Br0k3n 4cc3ss C0ntr0l/Lab-carlos.png" alt="alt text" title="Lab - Portswigger" /></p>

<h3 id="1Ô∏è‚É£-identifica√ß√£o-da-funcionalidade-vulner√°vel"><strong>1Ô∏è‚É£ Identifica√ß√£o da funcionalidade vulner√°vel</strong></h3>

<ul>
  <li>O site fornece um <strong>chat ao vivo</strong> onde as mensagens trocadas entre usu√°rios s√£o armazenadas e podem ser baixadas como um <strong>arquivo de transcript</strong> (<code class="language-plaintext highlighter-rouge">.txt</code>).</li>
  <li>Observamos que h√° uma op√ß√£o <strong>‚ÄúView transcript‚Äù</strong> para baixar o hist√≥rico do chat.</li>
  <li>O n√∫mero antes da extens√£o <code class="language-plaintext highlighter-rouge">.txt</code> indica um identificador √∫nico para cada transcript</li>
</ul>

<p><img src="/assets/img/Br0k3n 4cc3ss C0ntr0l/Live-chat.png" alt="alt text" title="Live Chat" /></p>

<p><img src="/assets/img/Br0k3n 4cc3ss C0ntr0l/Arquivo-txt.png" alt="alt text" title="Arquivo .TXT" /></p>

<h3 id="2Ô∏è‚É£-explora√ß√£o-da-vulnerabilidade-idor">2Ô∏è‚É£ <strong>Explora√ß√£o da vulnerabilidade IDOR</strong></h3>

<ul>
  <li>A vulnerabilidade ocorre porque o sistema <strong>n√£o valida se o usu√°rio tem permiss√£o para acessar um transcript espec√≠fico</strong>.</li>
  <li>Podemos testar manualmente se conseguimos acessar arquivos de outras sess√µes do chat, modificando o identificador na URL:</li>
  <li>Para verificar isso de forma mais eficiente, utilizamos o Burp Suite para interceptar a requisi√ß√£o e modificar o identificador.</li>
</ul>

<p><img src="/assets/img/Br0k3n 4cc3ss C0ntr0l/Recon-IDOR.png" alt="alt text" title="Recon IDOR" /></p>

<h3 id="3Ô∏è‚É£-uso-do-burp-suite-para-automa√ß√£o-do-ataque"><strong>3Ô∏è‚É£ Uso do Burp Suite para automa√ß√£o do ataque</strong></h3>

<h4 id="intercepta√ß√£o-da-requisi√ß√£o"><strong>Intercepta√ß√£o da requisi√ß√£o</strong></h4>

<ul>
  <li>No <strong>Burp Suite</strong>, acessamos a aba <strong>Proxy</strong> e capturamos a requisi√ß√£o <code class="language-plaintext highlighter-rouge">GET /download-transcript/2.txt HTTP/2</code>.</li>
  <li>Enviamos essa requisi√ß√£o para o <strong>Repeater</strong>, onde podemos test√°-la manualmente.</li>
</ul>

<p><img src="/assets/img/Br0k3n 4cc3ss C0ntr0l/Repter.png" alt="alt text" title="BurpSuite - Repeater" /></p>

<h4 id="manipula√ß√£o-do-id-do-transcript"><strong>Manipula√ß√£o do ID do transcript</strong></h4>

<ul>
  <li>Alteramos a requisi√ß√£o <code class="language-plaintext highlighter-rouge">GET</code> no <strong>Repeater</strong>, mudando <code class="language-plaintext highlighter-rouge">2.txt</code> para <code class="language-plaintext highlighter-rouge">1.txt</code>:</li>
  <li>Enviamos a requisi√ß√£o novamente.</li>
  <li>O servidor retorna um arquivo que pertence a outro usu√°rio.
    <h3 id="4Ô∏è‚É£-exposi√ß√£o-de-senha">4Ô∏è‚É£ <strong>Exposi√ß√£o de senha</strong></h3>
  </li>
  <li>
    <p>No conte√∫do do transcript <code class="language-plaintext highlighter-rouge">1.txt</code>, encontramos uma conversa onde um usu√°rio compartilha sua senha para confirma√ß√£o:</p>

    <p><code class="language-plaintext highlighter-rouge">You: Ok so my password is cep12xuxsha2ppv428j. Is that right? Hal Pline: Yes it is!</code></p>
  </li>
  <li>Esse √© um caso cl√°ssico de <strong>engenharia social</strong> dentro de um sistema vulner√°vel.</li>
</ul>

<p><img src="/assets/img/Br0k3n 4cc3ss C0ntr0l/Expondo-password.png" alt="alt text" title="Password" /></p>

<h3 id="5Ô∏è‚É£-login-como-o-usu√°rio-alvo"><strong>5Ô∏è‚É£ Login como o usu√°rio alvo</strong></h3>

<ul>
  <li>Agora que temos a senha <code class="language-plaintext highlighter-rouge">cep12xuxsha2ppv428j</code>, verificamos o objetivo do desafio:
    <ul>
      <li>No enunciado do laborat√≥rio, a miss√£o √© <strong>acessar a conta do usu√°rio ‚Äúcarlos‚Äù</strong>.</li>
    </ul>
  </li>
  <li>Usamos essas credenciais para tentar o login na plataforma como <strong>carlos</strong></li>
</ul>

<p><img src="/assets/img/Br0k3n 4cc3ss C0ntr0l/Login.png" alt="alt text" title="Login" /></p>

<p><img src="/assets/img/Br0k3n 4cc3ss C0ntr0l/Sucesso-login.png" alt="alt text" title="Sucesso" /></p>
